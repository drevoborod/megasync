# megasync

ОПИСАНИЕ

Утилита предназначена для РУЧНОЙ синхронизации одной выбранной директории
с хранилищем на mega.co.nz. Передача содержимого директории происходит в виде
зашифрованного архива.

Сведения по установке, настройке и запуску см. в installation.txt


АЛГОРИТМ

Утилита ищет на mega.co.nz указанную директорию ("Prefix" в шаблоне ниже), а в ней - файлы архивов,
созданные в определённом формате: 'Prefix_DD_MM_YY_HH_mm_ss_platformid.7z".
В этом шаблоне значимы Prefix, время создания и расширение ".7z". Platformid - опциональное произвольное поле.
Затем программа ищет аналогичные архивы в текущей
директории на локальном диске. Если архивы и на локальной машине, и на Меге
одинаковые (по времени создания с точностью до секунды. Время создания определяется только именем!), 
то утилита не делает ничего. Если где-то есть более новый архив,
то происходит синхронизация - самый новый архив копируется туда, где его нет:
- Если более новый файл на Меге, то он скачивается, распаковывается и его содержимым
заменяется указанная директория, при этом старая её версия переименовывается
в то же самое, но с постфиксом "_old".
- Если более новый файл на локальном диске, то он отправляется на Мегу.
Если ни там, ни там нет архивов, то указанная директория упаковывается
и архив отправляется на Мегу.
Если указан ключ командной строки "p", то указанная директория принудительно
упаковывается и архив отправляется на Мегу.

Все сравнения завязаны исключительно на формат имени файлов архивов, никаких проверок 
времени создания, размера и т.д. не производится.
Также, естественно, нет сравнения содержимого архивов на Меге, на локальном диске
и содержимого архивируемой директории, то есть, если у вас вдруг на диске отсутствует директория,
но есть самый свежий файл архива, никаких действий производиться не будет. То же самое - 
в случае, если в директории есть какие-то новые файлы, которых нет ни в одном из архивов.
Так что пользоваться так: добавил/изменил файлы - принудительно создал архив ключом "p".
Цель - не автоматическая, а ручная синхронизация, это не аналог rsync.
Цель приложения - обеспечить достаточно защищённое хранение личных данных в публичном облаке,
поэтому пароль к архивам должен быть сильным.
Создавалось приложение для удобной, в один клик, синхронизации важных документов между облаком
и несколькими устройствами. Но этот единственный клик должен производиться вручную на каждом устройстве.


ПРИМЕЧАНИЯ

На данный момент все создаваемые архивы остаются на Меге и локальном диске, пока
пользователь не удалит их вручную. Сделано специально в целях предосторожности,
так как приложение ещё сырое, могут быть ошибки. В дальнейшем планируется
реализовать такое поведение: при каждой синхронизации будут удаляться все архивы,
кроме трёх последних по времени.


!!!ВНИМАНИЕ!!!

Если пароль от архивов хранится в конфигурационном файле, то запускать утилиту
можно только на доверенных устройствах, так как пароль хранится в открытом виде.
